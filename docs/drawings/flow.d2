# QR Generator Flow

direction: down

title: {
  label: QR Code Generation Flow
  near: top-center
  shape: text
  style.font-size: 24
  style.bold: true
}

start: Start {
  shape: oval
  style.fill: "#c8e6c9"
}

cli_input: User provides CLI arguments {
  shape: parallelogram
  style.fill: "#e1f5ff"
}

parse: Parse arguments\nwith argparse {
  shape: rectangle
  style.fill: "#fff9c4"
}

init_config: Initialize Config\n~/qr-utils/ {
  shape: rectangle
  style.fill: "#fff9c4"
}

init_logger: Setup Logger\nto logs/ directory {
  shape: rectangle
  style.fill: "#fff9c4"
}

select_generator: Select appropriate\nQR Generator {
  shape: diamond
  style.fill: "#f8bbd0"
}

url_gen: URLQRGenerator {
  shape: rectangle
  style.fill: "#d1c4e9"
}

vcard_gen: VCardQRGenerator {
  shape: rectangle
  style.fill: "#d1c4e9"
}

wifi_gen: WiFiQRGenerator {
  shape: rectangle
  style.fill: "#d1c4e9"
}

other_gen: Other Generators... {
  shape: rectangle
  style.fill: "#d1c4e9"
}

prepare_data: prepare_data()\nFormat data for QR {
  shape: rectangle
  style.fill: "#ffccbc"
}

create_qr: create_qr_code()\nGenerate QR image {
  shape: rectangle
  style.fill: "#ffccbc"
}

check_logo: Logo provided? {
  shape: diamond
  style.fill: "#f8bbd0"
}

add_logo: add_logo()\nEmbed logo in center {
  shape: rectangle
  style.fill: "#ffccbc"
}

save_file: Save QR code to\noutput/ directory {
  shape: rectangle
  style.fill: "#b2dfdb"
}

success: Display success message\nwith file path {
  shape: parallelogram
  style.fill: "#c8e6c9"
}

end: End {
  shape: oval
  style.fill: "#c8e6c9"
}

error: Error Handler\nLog & display error {
  shape: rectangle
  style.fill: "#ffcdd2"
}

# Flow
start -> cli_input
cli_input -> parse
parse -> init_config
init_config -> init_logger
init_logger -> select_generator

select_generator -> url_gen: "url command"
select_generator -> vcard_gen: "vcard command"
select_generator -> wifi_gen: "wifi command"
select_generator -> other_gen: "other commands"

url_gen -> prepare_data
vcard_gen -> prepare_data
wifi_gen -> prepare_data
other_gen -> prepare_data

prepare_data -> create_qr
create_qr -> check_logo

check_logo -> add_logo: "Yes"
check_logo -> save_file: "No"
add_logo -> save_file

save_file -> success
success -> end

# Error handling
parse -> error: "Parse error" {style.stroke-dash: 3}
prepare_data -> error: "Data error" {style.stroke-dash: 3}
create_qr -> error: "QR error" {style.stroke-dash: 3}
add_logo -> error: "Logo error" {style.stroke-dash: 3}
save_file -> error: "I/O error" {style.stroke-dash: 3}
error -> end
